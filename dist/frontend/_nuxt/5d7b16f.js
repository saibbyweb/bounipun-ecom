(window.webpackJsonp=window.webpackJsonp||[]).push([[83,39,57],{529:function(e,t,r){"use strict";t.a={computed:{currency:function(){return this.$store.state.customerV2.currency},currencyIsINR:function(){return"INR"===this.currency}},methods:{formatCurrency:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e=parseFloat(e),this.$store.getters["customerV2/formatCurrency"](e,t)}}}},539:function(e,t,r){},550:function(e,t,r){},559:function(e,t,r){"use strict";r(539)},561:function(e,t,r){"use strict";r.r(t);var n=r(3),o=(r(22),r(41),r(268),r(264),{mixins:[r(529).a],mounted:function(){var e=this;setTimeout((function(){e.initializeCheckout&&e.createPaymentIntent()}),1e3)},props:{initializeCheckout:{type:Boolean,default:!1},deliveryAddress:Object},computed:{gatewayName:function(){return"INR"===this.currency?"razorpay":"stripe"},cartEmpty:function(){return 0===this.$store.state.customer.globalRemoteCart.length},coupon:function(){return this.$store.state.customer.coupon},couponApplied:function(){return!0===this.$store.state.customer.coupon.applied},discountValue:function(){if(!this.couponApplied)return 0;var e=0;switch(this.coupon.type){case"percentage":e=this.cartTotal*(this.coupon.value/100);break;case"direct-discount":e=this.coupon.value}return e.toFixed(2)},shippingCharge:function(){var e=this.$store.getters["customer/getTotalCartItems"],t=this.$store.getters["customer/getShippingCharge"]*e;return t.toFixed(2)},zeroShippingCharge:function(){return"0.00"===this.shippingCharge},taxes:function(){var e=this.$store.getters["customer/getTaxPercentage"];return(this.subTotal*(e/100)).toFixed(2)},zeroTaxes:function(){return"0.00"===this.taxes},subTotal:function(){var e=this.cartTotal-this.discountValue;return e.toFixed(2)},cartTotal:function(){var e=this.$store.getters["customer/getCartTotal"];return e.toFixed(2)},cartCount:function(){return this.$store.getters["customer/getCartCount"]},grandTotal:function(){var e=parseFloat(this.subTotal)+parseFloat(this.shippingCharge)+parseFloat(this.taxes);return e.toFixed(2)}},methods:{createPaymentIntent:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$post("/createPaymentIntent",{intentType:"order",amountToBeCharged:e.grandTotal,currency:e.currency.trim(),gateway:e.gatewayName,couponCode:e.coupon.code,deliveryAddress:e.deliveryAddress,combinedDeliveryConsent:e.$store.state.customer.combinedDeliveryConsent,giftMessage:e.$store.state.customer.giftMessage});case 2:if(r=t.sent,console.log(r),!1!==r.resolved){t.next=6;break}return t.abrupt("return");case 6:e.$emit("paymentIntentCreated",r.response);case 7:case"end":return t.stop()}}),t)})))()}}}),c=(r(559),r(9)),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"order-total"},[r("div",{staticClass:"data-point flex between"},[r("p",{staticClass:"name"},[e._v("\n      Cart Total: "),r("span",{staticClass:"count"},[e._v(" "+e._s(e.cartCount)+" Items (s) ")])]),e._v(" "),r("span",{staticClass:"value"},[e._v(" "+e._s(e.formatCurrency(e.cartTotal))+" ")])]),e._v(" "),r("hr"),e._v(" "),e.couponApplied?r("div",{staticClass:"data-point flex between"},[r("span",{staticClass:"name green"},[e._v(" Discount: ")]),e._v(" "),r("span",{staticClass:"value green small"},[e._v("\n      - "+e._s(e.formatCurrency(e.discountValue))+"\n    ")])]):e._e(),e._v(" "),e.couponApplied?r("hr"):e._e(),e._v(" "),e.couponApplied?r("div",{staticClass:"data-point flex between"},[r("span",{staticClass:"name"},[e._v(" Sub-Total: ")]),e._v(" "),r("span",{staticClass:"value"},[e._v("  "+e._s(e.formatCurrency(e.subTotal))+" ")])]):e._e(),e._v(" "),e.couponApplied?r("hr"):e._e(),e._v(" "),r("div",{staticClass:"data-point flex between"},[r("span",{staticClass:"name"},[e._v(" Shipping: ")]),e._v(" "),e.zeroShippingCharge?r("span",{staticClass:"value green small"},[e._v("\n      Free Shipping\n    ")]):r("span",{staticClass:"value small"},[e._v("\n      +"+e._s(e.formatCurrency(e.shippingCharge))+"\n    ")])]),e._v(" "),r("hr"),e._v(" "),r("div",{staticClass:"data-point flex between"},[r("span",{staticClass:"name"},[e._v(" Taxes: ")]),e._v(" "),e.zeroTaxes?r("span",{staticClass:"value green small"},[e._v(" Tax Included ")]):r("span",{staticClass:"value small"},[e._v("\n      + "+e._s(e.taxes)+"\n    ")])]),e._v(" "),r("hr"),e._v(" "),r("div",{staticClass:"data-point grand-total flex between"},[e._m(0),e._v(" "),r("span",{staticClass:"value"},[e._v(" "+e._s(e.formatCurrency(e.grandTotal))+" ")])])])}),[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",{staticClass:"name flex center col"},[e._v("\n      Grand Total: "),r("br")])}],!1,null,"862d703c",null);t.default=component.exports},562:function(e,t,r){"use strict";r(550)},581:function(e,t,r){"use strict";r.r(t);var n={mixins:[r(529).a],props:{item:Object,allowUpdate:{type:Boolean,default:!0}},data:function(){return{cartItem:{product:{},colorCode:"",quantity:0,variant:{},fabric:{}}}},computed:{cartItemPrice:function(){return this.currencyIsINR?this.item.price:this.item.pricing[this.currency]},totalCartItemPrice:function(){return this.cartItemPrice*this.item.quantity}},mounted:function(){},methods:{navigateToProductPage:function(){this.$router.push({path:"/".concat(this.item.slug)}),window.scroll({top:0,behavior:"smooth"})},getS3Path:function(e){return this.$getImage(e,"productPages")},emitUpdateQuantity:function(e,t){this.$emit("updateQuantity",{item:e.cartEntry,operation:t})},emitRemoveFromCart:function(e){this.$emit("removeItem",e.cartEntry)}}},o=(r(562),r(9)),component=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"cart-item",on:{click:function(t){return e.navigateToProductPage(e.item)}}},[r("div",{staticClass:"image-container",style:"background-image: url("+e.getS3Path(e.item.mainImage)+")"}),e._v(" "),r("div",{staticClass:"details-and-quantity"},[r("span",{staticClass:"name"},[e._v(" "+e._s(e.item.productName)+" ")]),e._v(" "),r("span",{staticClass:"color-name"},[e._v(" "+e._s(e.item.colorName)+" ")]),e._v(" "),r("span",{staticClass:"collection"},[e._v(" "+e._s(e.item.collectionName)+" ")]),e._v(" "),r("span",{staticClass:"variant"},[e._v(" "+e._s(e.item.variantName)+" ")]),e._v(" "),r("span",{staticClass:"fabric"},[e._v(" "+e._s(e.item.fabricName)+" ")]),e._v(" "),r("span",{staticClass:"fabric"},[e._v(" "+e._s(e.item.fabricInfo1)+" ")]),e._v(" "),e.item.askForPrice?e._e():r("span",{staticClass:"price"},[e._v("\n      "+e._s(e.formatCurrency(e.cartItemPrice))+"\n    ")]),e._v(" "),e.allowUpdate?e._e():r("span",{staticClass:"qty"},[e._v(" Qty: "+e._s(e.item.quantity)+" ")]),e._v(" "),r("span",{staticClass:"shippingTime"},[e._v("\n      Standard Shipping: "+e._s(e.item.shippingTime)+" week(s)\n    ")]),e._v(" "),e.allowUpdate?r("div",{staticClass:"quantity-picker"},[r("button",{on:{click:function(t){return t.stopPropagation(),e.emitUpdateQuantity(e.item,"decrease")}}},[e._v("-")]),e._v(" "),r("button",{staticClass:"qty"},[e._v(e._s(e.item.quantity))]),e._v(" "),r("button",{on:{click:function(t){return t.stopPropagation(),e.emitUpdateQuantity(e.item,"increase")}}},[e._v("+")])]):e._e()]),e._v(" "),e.allowUpdate?r("img",{staticClass:"remove-item",attrs:{src:"/icons/dark/remove-cart-item.png"},on:{click:function(t){return t.stopPropagation(),e.emitRemoveFromCart(e.item)}}}):e._e(),e._v(" "),e.item.askForPrice?e._e():r("p",{staticClass:"total-product-price"},[e._v("\n    "+e._s(e.formatCurrency(e.totalCartItemPrice))+"\n  ")])])}),[],!1,null,"6b018c96",null);t.default=component.exports},589:function(e,t,r){"use strict";(function(e){var n=r(95),o=r(3),c=(r(47),r(264),r(22),r(529)),l=(r(127),r(666));t.a={mixins:[c.a],head:function(){return{title:"Checkout | Bounipun Kashmir"}},mounted:function(){var e=this,t=function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$store.state.customer.authorized){t.next=2;break}return t.abrupt("return");case 2:return e.setKeys(),t.next=5,e.$store.dispatch("customer/fetchCart");case 5:return t.next=7,e.$store.dispatch("customer/fetchCoupon",e.coupon.code);case 7:return t.next=9,e.$store.dispatch("customer/fetchGlobalConfig");case 9:if(!e.cartEmpty){t.next=12;break}return e.$router.push("/"),t.abrupt("return");case 12:"INR"!==e.currency&&e.initializeStripe();case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()},data:function(){return{deliveryAddress:this.$route.params.deliveryAddress,remoteCartItems:this.$store.state.customer.globalRemoteCart,razorpayCheckout:null,stripe:null,paymentIntentId:"",paymentError:{status:!1,msg:""},gatewayToken:"",enableCheckout:!1,elements:null,orderDetails:{},combinedDeliveryConsent:!0,razorpayKeyId:"",stripePK:"",processingStripe:!1}},computed:{cartEmpty:function(){return 0===this.$store.state.customer.globalRemoteCart.length},coupon:function(){return this.$store.state.customer.coupon},gatewayName:function(){return"INR"===this.currency?"razorpay":"stripe"},stripeBillingAddress:function(){return{name:this.deliveryAddress.firstName+" "+this.deliveryAddress.surName,email:this.deliveryAddress.email,address:{city:this.deliveryAddress.city,line1:this.deliveryAddress.addressLine1+" | "+this.deliveryAddress.addressLine2,postal_code:this.deliveryAddress.postalCode,country:this.deliveryAddress.countryIsoCode}}},stripeShippingObject:function(){return{address:{line1:this.deliveryAddress.addressLine1+" "+this.deliveryAddress.addressLine2,country:this.deliveryAddress.countryIsoCode},name:this.deliveryAddress.firstName+" "+this.deliveryAddress.surName}},maximumShippingTime:function(){var e=this.$store.state.customer.globalRemoteCart.map((function(e){return e.shippingTime})),t=Math.max.apply(Math,Object(n.a)(e));return t}},methods:{setKeys:function(){if("development"===e.env.MODE)return this.razorpayKeyId=e.env.VITE_RAZORPAY_KEY_ID_TEST,void(this.stripePK=e.env.VITE_STRIPE_PK_TEST);if("bounipun.in"===window.location.hostname)this.razorpayKeyId="rzp_live_bzpnf6YPxKKfTh",this.stripePK="pk_live_51J0qm7SAJnKcquR3JZ1T9qVG8lGA4bIflVcp5TZFWYP06n6XPLWojyNYUc5PMUFEwWCoe62IHW9HsnebRlpl5Scw00LC38Ktxu";else this.razorpayKeyId="rzp_test_LnJPEC0MOtvlSn",this.stripePK="pk_test_51J0qm7SAJnKcquR3vsOUPap0r0P1vwuEA75yfexoRqRRouVuc2uagePU0RZOPFCDK6VNAhgHOSnzJOfRYo78YUhQ00C4FhrbSV"},initializeStripe:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var element;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(l.a)(e.stripePK);case 2:e.stripe=t.sent,e.elements=e.stripe.elements(),(element=e.elements.create("card",{hidePostalCode:!0})).on("change",(function(t){e.paymentError.status=!1,t.complete?e.enableCheckout=!0:e.enableCheckout=!1})),element.mount("#stripe-mount");case 7:case"end":return t.stop()}}),t)})))()},onPaymentIntentCreated:function(details){this.paymentIntentId=details.intentId,this.gatewayToken=details.gatewayToken,"razorpay"===this.gatewayName&&this.setupRazorpayOrder(details.gatewayToken,details.amount)},setupRazorpayOrder:function(e,t){var r,n=this,c={key:this.razorpayKeyId,amount:t,currency:"INR",name:"Bounipun Ecom",description:"Test Transaction",image:"https://example.com/your_logo",order_id:e,handler:(r=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),r=t.razorpay_order_id,o=t.razorpay_payment_id,t.razorpay_signature,e.next=4,n.$post("/razorpayPaymentSuccess",{razorpay_order_id:r,transactionId:o});case 4:if(!1!==e.sent.resolved){e.next=7;break}return e.abrupt("return");case 7:n.$store.dispatch("customer/fetchCart"),n.$router.push("/order-placed-successfully");case 9:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)}),prefill:{name:this.deliveryAddress.firstName+" "+this.deliveryAddress.surName,email:this.deliveryAddress.email,contact:this.deliveryAddress.mobileNumber},theme:{color:"#3399cc"}};this.razorpayCheckout=new Razorpay(c),this.enableCheckout=!0},placeOrder:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.enableCheckout){t.next=2;break}return t.abrupt("return",!1);case 2:return"INR"===e.currency.trim()?e.razorpayCheckout.open():e.stripeCheckout(),t.abrupt("return");case 4:case"end":return t.stop()}}),t)})))()},stripeCheckout:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,o,c,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.processingStripe){t.next=2;break}return t.abrupt("return");case 2:return e.processingStripe=!0,r=e.elements.getElement("card"),e.$store.commit("customer/setLoading",!0),t.next=7,e.stripe.createPaymentMethod({type:"card",card:r,billing_details:e.stripeBillingAddress});case 7:if(n=t.sent,o=n.paymentMethod,c=n.error,e.$store.commit("customer/setLoading",!1),!c){t.next=17;break}return console.log("could not process payment method request"),e.paymentError.msg="Could not process payment. Kindly try after sometime.",e.paymentError.status=!0,e.processingStripe=!1,t.abrupt("return");case 17:return console.log(o),e.$store.commit("customer/setLoading",!0),t.next=21,e.stripe.confirmCardPayment(e.gatewayToken,{payment_method:o.id,shipping:e.stripeShippingObject});case 21:if(l=t.sent,d=l.error,e.$store.commit("customer/setLoading",!1),e.processingStripe=!1,!d){t.next=31;break}return console.log("could not process STRIPE PAYMENT"),console.log(d),e.paymentError.msg="We are facing some technical difficulties at the moment. Kindly, try again after sometime.",e.paymentError.status=!0,t.abrupt("return");case 31:e.$store.dispatch("customer/fetchCart"),e.$router.push("/order-placed-successfully");case 33:case"end":return t.stop()}}),t)})))()}}}}).call(this,r(133))},603:function(e,t,r){},666:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n="https://js.stripe.com/v3",o=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,c="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",l=null,d=function(e){return null!==l||(l=new Promise((function(t,r){if("undefined"!=typeof window)if(window.Stripe&&e&&console.warn(c),window.Stripe)t(window.Stripe);else try{var script=function(){for(var e=document.querySelectorAll('script[src^="'.concat(n,'"]')),i=0;i<e.length;i++){var script=e[i];if(o.test(script.src))return script}return null}();script&&e?console.warn(c):script||(script=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",script=document.createElement("script");script.src="".concat(n).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(script),script}(e)),script.addEventListener("load",(function(){window.Stripe?t(window.Stripe):r(new Error("Stripe.js not available"))})),script.addEventListener("error",(function(){r(new Error("Failed to load Stripe.js"))}))}catch(e){return void r(e)}else t(null)}))),l},m=function(e,t,r){if(null===e)return null;var n=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.22.0",startTime:t})}(n,r),n},v=Promise.resolve().then((function(){return d(null)})),h=!1;v.catch((function(e){h||console.warn(e)}));var f=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];h=!0;var n=Date.now();return v.then((function(e){return m(e,t,n)}))}},667:function(e,t,r){"use strict";r(603)},803:function(e,t,r){"use strict";r.r(t);var n=r(589).a,o=(r(667),r(9)),component=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"checkout-page page -wh"},[e._m(0),e._v(" "),r("div",{staticClass:"order-overview flex center"},[r("div",{staticClass:"cart-items flex center col"},[r("h3",{staticClass:"section-heading"},[e._v("Products")]),e._v(" "),e._l(e.$store.state.customer.globalRemoteCart,(function(e,t){return r("CartItem",{key:t,attrs:{item:e,allowUpdate:!1}})}))],2),e._v(" "),r("div",{staticClass:"d-o-p flex center col"},[r("h3",{staticClass:"section-heading"},[e._v("Delivery Address")]),e._v(" "),r("div",{staticClass:"delivery-address"},[r("span",{staticClass:"name"},[e._v("\n          "+e._s(e.deliveryAddress.firstName)+" "+e._s(e.deliveryAddress.surName)+"\n        ")]),e._v(" "),r("span",[e._v(" "+e._s(e.deliveryAddress.addressLine1))]),e._v(" "),r("span",[e._v(" "+e._s(e.deliveryAddress.addressLine2)+" ")]),e._v(" "),r("span",[e._v(" "+e._s(e.deliveryAddress.state||"")+" ")]),e._v(" "),r("span",[e._v(" "+e._s(e.deliveryAddress.city)+" ")]),e._v(" "),r("span",[e._v(" "+e._s(e.deliveryAddress.postalCode)+" ")]),e._v(" "),r("span",[e._v(" "+e._s(e.deliveryAddress.mobileNumber)+" ")])]),e._v(" "),r("div",{staticClass:"order-total-container"},[e.cartEmpty?e._e():r("OrderTotal",{attrs:{deliveryAddress:e.deliveryAddress,initializeCheckout:!0},on:{paymentIntentCreated:e.onPaymentIntentCreated}})],1),e._v(" "),r("div",{staticClass:"payment-specific flex center col"},[e.$store.state.customer.combinedDeliveryConsent?r("p",{staticClass:"note"},[e._v("\n          Combined Standard shipping for the whole order:\n          "+e._s(e.maximumShippingTime)+" weeks\n        ")]):e._e(),e._v(" "),"stripe"===e.gatewayName?r("h2",{staticClass:"payment-title"},[e._v("\n          Payment Information\n        ")]):e._e(),e._v(" "),"stripe"===e.gatewayName?r("div",{attrs:{id:"stripe-mount"}}):e._e(),e._v(" "),e.paymentError.status?r("p",{staticClass:"msg error"},[e._v("\n          "+e._s(e.paymentError.msg)+"\n        ")]):e._e(),e._v(" "),r("button",{staticClass:"action checkout-btn",class:{disabled:!e.enableCheckout},on:{click:e.placeOrder}},[e._v("\n          Place Order\n        ")])])])])])}),[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page-header center"},[r("h2",{staticClass:"title"},[e._v("Checkout")])])}],!1,null,"26bd1878",null);t.default=component.exports;installComponents(component,{CartItem:r(581).default,OrderTotal:r(561).default})}}]);