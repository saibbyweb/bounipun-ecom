(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{520:function(e,t,n){},532:function(e,t,n){"use strict";n(520)},535:function(e,t,n){"use strict";n.r(t);var l=n(3),o=(n(22),n(13),n(33),n(35),n(36),n(547),n(266),n(28),n(41),n(169),{props:{label:{type:String,default:"Add Files"},multipleUpload:{type:Boolean,default:!0},uploadType:{type:String,default:"non-product"},uploaded:Array},data:function(){return{cancelToken:this.$axios.CancelToken,images:[],uploadImageAPI:"/uploadImage"}},methods:{clearFileSelection:function(){this.images=[]},assignImages:function(e){var t=this;if(console.log("ASSIGN IMAGES WAS CALLED"),!(!e.length>0)){this.images=[];e.forEach((function(image){var e={file:null,previewURL:"https://bounipun-ecom.s3.ap-south-1.amazonaws.com/original/"+image.path,cancelToken:null,uploadPercentage:100,uploaded:!0,mainImage:image.mainImage,_id:image._id,path:image.path};t.images.push(e)}))}},addFiles:function(){this.$refs.selector.click()},handleFileSelection:function(){var e=this,t=this.$refs.selector.files;this.multipleUpload||(this.images=[]),t.forEach((function(t){var n=e.createImageObject(t);e.images.push(n),e.uploadFile(n),e.resetFileSelection()}))},createImageObject:function(e){return{file:e,previewURL:URL.createObjectURL(e),cancelToken:this.cancelToken.source(),uploadPercentage:0,uploaded:!1,mainImage:!1,_id:"",path:""}},uploadFile:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var l,o,c,r,d,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(l=new FormData).append("productImage",e.file),l.append("uploadType",t.uploadType),o=t.setUploadConfig(e),c=t.$axios.$post(t.uploadImageAPI,l,o),n.next=7,t.$task(c);case 7:if(r=n.sent,d=r.response,!(m=r.error)){n.next=13;break}return t.$axios.isCancel(m)&&console.log("Upload request cancelled"),n.abrupt("return");case 13:t.updateImageObject(e,d);case 14:case"end":return n.stop()}}),n)})))()},setUploadConfig:function(e){return{cancelToken:e.cancelToken.token,headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(progress){e.uploadPercentage=parseInt(Math.round(progress.loaded/progress.total*100))}}},updateImageObject:function(e,t){e.uploaded=100===e.uploadPercentage,e.path=t.name,e._id=t._id,this.$emit("updated",this.images)},setMainImage:function(e,t){var n=this;if(t)for(var i=0;i<this.images.length;i++)i!==e&&(this.images[i].mainImage=!1);setTimeout((function(){n.images[e].mainImage=!0,n.$emit("updated",n.images)}),100)},removeFile:function(e){this.images[e].uploaded||this.images[e].cancelToken.cancel(),this.images.splice(e,1),this.$emit("updated",this.images)},resetFileSelection:function(){this.$refs.selector.type="text",this.$refs.selector.type="file"}}}),c=(n(532),n(9)),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-container"},[n("label",{staticClass:"label"},[e._v(" "+e._s(e.label)+" ")]),e._v(" "),n("input",{ref:"selector",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*",multiple:e.multipleUpload},on:{change:function(t){return e.handleFileSelection()}}}),e._v(" "),n("button",{staticClass:"file-selector",on:{click:function(t){return e.addFiles()}}},[e._v("\n    Select File(s)\n  ")]),e._v(" "),n("div",{staticClass:"previews"},[e._l(e.images,(function(image,t){return n("div",{key:t,staticClass:"preview center",class:{uploading:!image.uploaded},style:{backgroundImage:"url("+image.previewURL+")"}},[n("div",{staticClass:"actions center-col"},[n("img",{staticClass:"remove-file",attrs:{src:"/icons/light/remove-icon.png"},on:{click:function(n){return e.removeFile(t)}}}),e._v(" "),e.multipleUpload?n("input",{directives:[{name:"model",rawName:"v-model",value:image.mainImage,expression:"image.mainImage"}],staticClass:"set-main-image",attrs:{type:"checkbox"},domProps:{checked:image.mainImage,checked:Array.isArray(image.mainImage)?e._i(image.mainImage,null)>-1:image.mainImage},on:{change:[function(t){var n=image.mainImage,l=t.target,o=!!l.checked;if(Array.isArray(n)){var c=e._i(n,null);l.checked?c<0&&e.$set(image,"mainImage",n.concat([null])):c>-1&&e.$set(image,"mainImage",n.slice(0,c).concat(n.slice(c+1)))}else e.$set(image,"mainImage",o)},function(n){return e.setMainImage(t,n.target.checked)}]}}):e._e()]),e._v(" "),image.uploaded?e._e():n("div",{staticClass:"progress center"},[n("vue-ellipse-progress",{attrs:{color:"#41bf89",size:70,thickness:7,legend:!0,fontSize:"1rem",progress:image.uploadPercentage}},[n("img",{staticClass:"upload-icon",attrs:{slot:"legend-caption",wdith:"60px",src:"/icons/light/upload-cloud.svg"},slot:"legend-caption"})])],1),e._v(" "),image.mainImage?n("span",{staticClass:"main-image"},[e._v(" Main Image ")]):e._e(),e._v(" "),n("span",{staticClass:"numbering"},[e._v(" "+e._s(t+1)+" ")])])})),e._v(" "),0===e.images.length?n("div",{staticClass:"not-uploaded",staticStyle:{"margin-left":"10px"}},[n("img",{attrs:{src:"/icons/light/upload-cloud.svg"}}),e._v(" "),n("span",[e._v(" No Image(s) uploaded yet ")])]):e._e()],2)])}),[],!1,null,"5d760990",null);t.default=component.exports}}]);